{% extends "virtuallibrary/base.html" %}
{% load static %}

{% block title %}My virtuallibrary{% endblock %}

{% block content %}
 <h1>My virtuallibrary</h1>

{% if tag %}
<h2>Books tagged with "{{ tag.name }}"</h2>
{% endif %}

 <form method="get" action="{% url 'virtuallibrary:book_list' %}">
     {{ search_form.query }}
     <button type="submit">Buscar</button>
 </form>

{% for book in books %}
    {% if book.cover %}
        <img src="{{ book.cover.url }}" alt="{{ book.title }} cover" width="150">
    {% else %}
        <!-- capa padrão opcional -->
        <img src="{% static 'images/default_cover.png' %}" alt="Capa padrão" width="150">
    {% endif %}

    <h2>
        <a href="{% url 'virtuallibrary:book_detail' book.id %}">
            {{ book.title }}
        </a>
    </h2>

<p class="tags">
    Tags: 
    {% for tag in book.tags.all %}
        <a href="{% url 'virtuallibrary:book_list_by_tag' tag.slug %}">
            {{ tag.name }}
        </a>{% if not forloop.last %}, {% endif %}
    {% endfor %}
</p>

<p class="date">
    Published {{ book.publish }} by {{ book.author }}
 </p>

    {{ book.body|truncatewords:30|linebreaks }}
{% endfor %}

{% include "pagination.html" with page=books %}
{% endblock %}